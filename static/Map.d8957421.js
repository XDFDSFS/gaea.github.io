import{_ as D}from"./client-only.bab1b30b.js";import{d as I,r as f,q as B,am as L,o as N,n as $,$ as F,a as O,c as A,b as d,bf as b,g as R,w as V,t as W,e as q,M as w,p as H,l as J,m as U}from"./entry.fd3f1e90.js";import{a as j}from"./dashboard.3bbf6b00.js";let i=null;const S=(o,s=500,u=!1)=>{if(i!==null&&clearTimeout(i),u){const p=!i;i=setTimeout(function(){i=null},s),p&&typeof o=="function"&&o()}else i=setTimeout(function(){typeof o=="function"&&o()},s)},x=o=>(H("data-v-1eaebc6b"),o=o(),J(),o),G={class:"w-full h-full min-h-[250px] bg-[#0F0F0F] rounded-lg shadow-3d relative"},K=["id"],P=x(()=>d("div",{class:"w-3 h-3 bg-[#30b60b] rounded-full glow-effect"},null,-1)),Q=x(()=>d("span",{class:"text-[#747576] text-sm leading-[14px]"},"Workers: ",-1)),X={class:"text-[#747576] text-base leading-4"},Y=I({__name:"Map",props:{id:{default:"echartMap"},data:{default:()=>[]}},setup(o){const s=o,{$eChart:u}=w(),{$worldData:p}=w(),C=p;u.registerMap("world",C);const t=f(),m=f(!0),v=f(null),h=f(),z=e=>{const a=new Map,l=[],n=[];for(let c=0;c<e.length;c++){const r=e[c];a.has(r.country)||a.set(r.country,{name:r.country,itemStyle:{areaColor:"#866c50",borderColor:"#d9af80"}}),l.push({coords:[[r.longitude,r.latitude],[103.51,1.16]]}),n.push({value:[r.longitude,r.latitude]})}return{regionsData:Array.from(a.values()),linesData:l,effectScatterEnd:n}},k=B(()=>z(s.data)),M=e=>({type:"lines",zlevel:2,effect:{color:"#d9af80",show:!0,period:2,trailLength:.4,symbol:"pin",symbolSize:8},lineStyle:{width:1,opacity:1,curveness:.5,color:"rgba(255, 255, 255, 0.4)"},data:e}),_=e=>({type:"effectScatter",coordinateSystem:"geo",zlevel:1,showEffectOn:"render",symbolSize:8,rippleEffect:{number:4,period:4,scale:3,brushType:"stroke"},itemStyle:{color:"#d9af80"},data:e}),g=async()=>{t.value&&(t.value.dispose(),t.value=null);const e=document.getElementById(s.id);if(!e||e.clientWidth===0||e.clientHeight===0)return;t.value=u.init(e);const{regionsData:a,linesData:l,effectScatterEnd:n}=k.value,c={animation:!1,progressive:500,progressiveThreshold:3e3,geo:{type:"map",map:"world",zoom:1.2,roam:!0,scaleLimit:{min:1.2,max:3},itemStyle:{areaColor:"rgba(51, 51, 51,1)",borderColor:"rgba(51, 51, 51,1)",borderType:"dotted"},emphasis:{itemStyle:{areaColor:"#866c50"},label:{show:!1,color:"#fff"}},regions:a},series:[M(l),_([s.data.length>0?[103.51,1.16]:[]]),_(n)]};t.value.setOption(c)};L(()=>s.data,()=>{m.value&&S(g,300)},{deep:!0});const T=async()=>{try{const e=await j();e.code===200&&(h.value=e.data)}catch(e){console.error("error:",e)}},E=()=>{t.value&&t.value.resize()},y=()=>{t.value&&S(E(),300)};return N(async()=>{m.value=!0,await $(),T(),g(),window.addEventListener("resize",y)}),F(()=>{m.value=!1,t.value&&(t.value.dispose(),t.value=null),v.value&&clearTimeout(v.value),window.removeEventListener("resize",y)}),(e,a)=>{const l=D;return O(),A("div",G,[d("div",{id:e.id,class:"w-full h-full"},null,8,K),a[0]||(b(-1),a[0]=d("div",{class:"w-fit absolute left-5 bottom-3 flex items-center space-x-1"},[P,Q,R(l,null,{default:V(()=>{var n;return[d("span",X,W(((n=q(h))==null?void 0:n.devices_connected)||0),1)]}),_:1})]),b(1),a[0])])}}});const oe=U(Y,[["__scopeId","data-v-1eaebc6b"]]);export{oe as default};
