import{d as T,r as p,k as z,ab as D,o as I,n as L,O as B,a as N,c as O,b as u,b9 as g,f as A,w as F,t as R,u as V,_ as P,p as W,i as $,I as j,j as H}from"./entry.a7557f9a.js";import{_ as U}from"./client-only.43865359.js";import{a as q}from"./dashboard.52a8e5e6.js";import"./dict.d4f65729.js";import"./user.0d421798.js";let i=null;const w=(o,s=500,c=!1)=>{if(i!==null&&clearTimeout(i),c){const t=!i;i=setTimeout(function(){i=null},s),t&&typeof o=="function"&&o()}else i=setTimeout(function(){typeof o=="function"&&o()},s)},b=o=>(W("data-v-4d906168"),o=o(),$(),o),G={class:"w-full h-full min-h-[250px] bg-[#0F0F0F] rounded-lg shadow-3d relative"},J=["id"],K=b(()=>u("div",{class:"w-3 h-3 bg-[#30b60b] rounded-full glow-effect"},null,-1)),Q=b(()=>u("span",{class:"text-[#747576] text-sm leading-[14px]"},"Workers: ",-1)),X={class:"text-[#747576] text-base leading-4"},Y=T({__name:"Map",props:{id:{default:"echartMap"},data:{default:()=>[]}},setup(o){const s=o,{$eChart:c}=j(),t=p(),f=p(!0),m=p(null),_=p(),S=e=>{const a=new Map,l=[],n=[];for(let d=0;d<e.length;d++){const r=e[d];a.has(r.country)||a.set(r.country,{name:r.country,itemStyle:{areaColor:"#866c50",borderColor:"#d9af80"}}),l.push({coords:[[r.longitude,r.latitude],[103.51,1.16]]}),n.push({value:[r.longitude,r.latitude]})}return{regionsData:Array.from(a.values()),linesData:l,effectScatterEnd:n}},x=z(()=>S(s.data)),C=e=>({type:"lines",zlevel:2,effect:{color:"#d9af80",show:!0,period:2,trailLength:.4,symbol:"pin",symbolSize:8},lineStyle:{width:1,opacity:1,curveness:.5,color:"rgba(255, 255, 255, 0.4)"},data:e}),v=e=>({type:"effectScatter",coordinateSystem:"geo",showEffectOn:"render",symbolSize:8,rippleEffect:{number:4,period:4,scale:3,brushType:"stroke"},itemStyle:{color:"#d9af80"},data:e}),h=async()=>{t.value&&(t.value.dispose(),t.value=null);const e=document.getElementById(s.id);if(!e||e.clientWidth===0||e.clientHeight===0)return;t.value=c.init(e);const{regionsData:a,linesData:l,effectScatterEnd:n}=x.value,d={animation:!1,progressive:500,progressiveThreshold:3e3,geo:{type:"map",map:"world",zoom:1.2,roam:!0,scaleLimit:{min:1.2,max:3},itemStyle:{areaColor:"rgba(51, 51, 51,1)",borderColor:"rgba(51, 51, 51,1)",borderType:"dotted"},emphasis:{itemStyle:{areaColor:"#866c50"},label:{show:!1,color:"#fff"}},regions:a},series:[C(l),v([s.data.length>0?[103.51,1.16]:[]]),v(n)]};t.value.setOption(d)};D(()=>s.data,()=>{f.value&&w(h,300)},{deep:!0});const k=async()=>{try{const e=await q();e.code===200&&(_.value=e.data)}catch(e){console.error("error:",e)}},E=()=>{t.value&&t.value.resize()},y=()=>{t.value&&w(E(),300)},M=async()=>{if(!c.getMap("world")){const{default:e}=await P(()=>import("./world.2e1df9a7.js"),[],import.meta.url);c.registerMap("world",e)}};return I(async()=>{f.value=!0,await M(),await L(),k(),h(),window.addEventListener("resize",y)}),B(()=>{f.value=!1,t.value&&(window.removeEventListener("resize",y),t.value.dispose(),t.value=null),m.value&&clearTimeout(m.value)}),(e,a)=>{const l=U;return N(),O("div",G,[u("div",{id:e.id,class:"w-full h-full"},null,8,J),a[0]||(g(-1),a[0]=u("div",{class:"w-fit absolute left-5 bottom-3 flex items-center space-x-1"},[K,Q,A(l,null,{default:F(()=>{var n;return[u("span",X,R(((n=V(_))==null?void 0:n.devices_connected)||0),1)]}),_:1})]),g(1),a[0])])}}});const se=H(Y,[["__scopeId","data-v-4d906168"]]);export{se as default};
